(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-5906"],{"2T4I":function(e,t,i){},"4iHv":function(e,t,i){"use strict";i.r(t);var r=i("t3Un"),o=i("bs5h");function a(e){return Object(r.a)({url:o.a.POSTS,method:"get",params:e})}var l=i("Ztr3"),s=i("stgD");i("ZOF2");var n={components:{mavonEditor:s.mavonEditor},filters:{statusFilter:function(e){return{published:"success",draft:"gray",deleted:"danger"}[e]}},methods:{switchChange:function(e){this.createFormVisiblePreviewImg=!this.createFormVisiblePreviewImg,this.createFormVisibleElUpload=!this.createFormVisibleElUpload,this.editFormVisibleElUpload=!this.editFormVisibleElUpload,this.editFormVisiblePreviewImg=!this.editFormVisiblePreviewImg},$imgAdd:function(e,t){var i=this,o=new FormData;o.append("smfile",t),function(e){return Object(r.a)({url:"/sm.ms/api/upload",method:"post",data:e})}(o).then(function(t){"success"==t.code&&i.$refs.md.$img2Url(e,t.data.url)}).catch(function(e){alert(e)})},$imgDel:function(e){delete this.img_file[e]},handleSizeChange:function(e){var t=this;this.listLoading=!0,a({limit:e,page:this.currentPage,keyword:this.keyword}).then(function(e){t.list=e.data.List,t.listLoading=!1,t.currentPage=e.data.PageNo,t.total=e.data.TotalCount,t.limit=parseInt(e.data.PageSize)})},handleCurrentChange:function(e){var t=this;this.listLoading=!0,a({page:e,limit:this.limit,keyword:this.keyword}).then(function(e){t.list=e.data.List,t.listLoading=!1,t.currentPage=e.data.PageNo,t.total=e.data.TotalCount,t.limit=parseInt(e.data.PageSize)})},handleSearch:function(){var e=this;this.listLoading=!0,a({keyword:this.keyword,limit:this.limit}).then(function(t){e.list=t.data.List,e.listLoading=!1,e.currentPage=t.data.PageNo,e.total=t.data.TotalCount,e.limit=parseInt(t.data.PageSize)})},handleCreate:function(){this.dialogCreateFormVisible=!0},handleEdit:function(e,t){this.dialogFormVisible=!0;var i=t;this.editForm.post_id=i.Id,this.editForm.category_id=i.CategoryId,this.editForm.title=i.Title,this.editForm.video=i.VideoUrl,this.editForm.is_recommend=i.IsRecommend,this.editForm.preview_img=i.VideoCover,this.editForm.preview_img_show=[{name:i.VideoCover,url:i.VideoCover}],this.editForm.html_content=i.HtmlContent,this.editForm.content=i.Content,this.editForm.slug=i.Slug},handleDelete:function(e,t){var i=this;this.$confirm("此操作将删除该文章, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){i.listLoading=!0,function(e){return Object(r.a)({url:o.a.POSTS+"/"+e.id,method:"delete"})}({id:t.Id}).then(function(e){i.listLoading=!1,i.$message({type:"success",message:"删除成功!"}),i.fetchData()})}).catch(function(){i.$message({type:"info",message:"已取消删除"})})},handleRemove:function(e,t){this.editForm.preview_img_show=[],console.log(e,t)},handlePreviewImg:function(e){console.log(e)},handleUploadPreviewImg:function(e,t){"success"==e.code?(this.editForm.preview_img=e.data.url,this.editForm.preview_img_show=[{name:e.data.storename,url:e.data.url}]):(this.$message.error(e.message),this.editForm.preview_img_show=[],this.editForm.preview_img="")},beforePreviewImgUpload:function(e){this.editForm.preview_img_show.length>=1&&this.$message.error("只能上传一张");var t="image/jpeg"===e.type,i="image/gif"===e.type,r="image/png"===e.type,o="image/bmp"===e.type;t||i||r||o||this.$message.error("上传图片必须是JPG/GIF/PNG/BMP 格式!");var a=e.size/1024/1024/1024/1024/1024<5;return a||this.$message.error("上传头像图片大小不能超过 5MB!"),a},handleCreateRemove:function(e,t){this.editForm.preview_img_show=[],console.log(e,t)},handleCreatePreviewImg:function(e){console.log("asdasdada"),console.log(e)},handleCreateUploadPreviewImg:function(e,t){"success"==e.code?(this.createForm.preview_img=e.data.url,this.createForm.preview_img_show=[{name:e.data.storename,url:e.data.url}]):(this.$message.error(e.message),this.createForm.preview_img_show=[],this.createForm.preview_img="")},beforeCreatePreviewImgUpload:function(e){this.createForm.preview_img_show.length>=1&&this.$message.error("只能上传一张");var t="image/jpeg"===e.type,i="image/gif"===e.type,r="image/png"===e.type,o="image/bmp"===e.type;t||i||r||o||this.$message.error("上传图片必须是JPG/GIF/PNG/BMP 格式!");var a=e.size/1024/1024/1024/1024/1024<5;return a||this.$message.error("上传头像图片大小不能超过 5MB!"),a},fetchData:function(){var e=this;this.listLoading=!0,a({page:this.currentPage,limit:this.limit,keyword:this.keyword}).then(function(t){e.list=t.data.List,e.listLoading=!1,e.currentPage=t.data.PageNo,e.total=t.data.TotalCount,e.limit=parseInt(t.data.PageSize)}),Object(l.b)().then(function(t){e.categories=t.data,e.createForm.category_id=t.data[0].id})},submitCreateForm:function(e){var t=this;this.$refs[e].validate(function(i){return""===t.createForm.preview_img?(t.$message.error("封面图必须上传"),!1):i?void function(e){return Object(r.a)({url:o.a.POSTS,method:"post",data:e})}({title:t.createForm.title,slug:t.createForm.slug,content:t.createForm.content,video_url:t.createForm.video,video_cover:t.createForm.preview_img,category_id:t.createForm.category_id,is_recommend:t.createForm.is_recommend}).then(function(i){t.dialogCreateFormVisible=!1,t.$message({type:"success",message:"添加成功!"}),t.fetchData(),t.$refs[e].resetFields()}):(t.dialogCreateFormVisible=!0,!1)})},submitEditForm:function(e){var t=this;this.$refs[e].validate(function(i){return""===t.editForm.preview_img?(t.$message.error("封面图必须上传"),!1):i?void function(e){return Object(r.a)({url:o.a.POSTS+"/"+e.id,method:"put",data:e})}({id:t.editForm.post_id,title:t.editForm.title,slug:t.editForm.slug,content:t.editForm.content,video_url:t.editForm.video,video_cover:t.editForm.preview_img,category_id:t.editForm.category_id,is_recommend:t.editForm.is_recommend}).then(function(i){t.dialogFormVisible=!1,t.$message({type:"success",message:"修改成功!"}),t.fetchData(),t.$refs[e].resetFields()}):(t.dialogFormVisible=!0,!1)})}},data:function(){return{currentPage:1,total:0,limit:10,keyword:"",list:null,listLoading:!0,categories:[],tags:[],img_file:[],editListLoading:!0,dialogFormVisible:!1,dialogCreateFormVisible:!1,createFormVisibleElUpload:!0,editFormVisibleElUpload:!0,createFormVisiblePreviewImg:!1,editFormVisiblePreviewImg:!1,smUploadHeader:{Accept:"application/json","Content-Type":"application/json"},editForm:{post_id:0,title:"",description:"",slug:"",content:"",html_content:"",video:"",preview_img:"",preview_img_show:[],category_id:0,is_recommend:"0"},customize_preview_img:!1,createForm:{title:"",description:"",slug:"",content:"",html_content:"",video:"",preview_img:"",preview_img_show:[],category_id:0,is_recommend:"0"},formLabelWidth:"120px",rules:{title:[{required:!0,message:"请输标题",trigger:"blur"}],description:[{required:!0,message:"请输描述",trigger:"blur"}],content:[{required:!0,message:"请输入内容",trigger:"blur"}],category_id:[{required:!0,message:"请选择活动区域",trigger:"change"}],video:[{required:!0,message:"视频地址必填",trigger:"blur"}]}}},created:function(){this.fetchData()}},m=(i("GQkZ"),i("KHd+")),d=Object(m.a)(n,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"blog-search-div"},[e._v("\n      搜索： "),i("span",{staticClass:"search-input"},[i("el-input",{attrs:{placeholder:"请输入内容","prefix-icon":"el-icon-search",size:"small"},on:{blur:e.handleSearch},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1)]),e._v(" "),i("div",{staticStyle:{"padding-right":"20px","padding-top":"10px",float:"right",display:"inline"}},[i("el-button",{attrs:{type:"primary",icon:"el-icon-plus",circle:""},on:{click:e.handleCreate}})],1),e._v(" "),i("div",{staticClass:"app-container"},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{align:"center",label:"ID",width:"95"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.Id)+"\n          ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"类别"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.CategoryName)+"\n          ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"标题"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.Title)+"\n          ")]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"封面图"},scopedSlots:e._u([{key:"default",fn:function(e){return[i("img",{attrs:{src:e.row.VideoCover,width:"40px",height:"40px"}})]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",prop:"created_at",label:"添加时间",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("i",{staticClass:"el-icon-time"}),e._v(" "),i("span",[e._v(e._s(t.row.CreatedAt))])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{size:"mini"},on:{click:function(i){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),i("p"),e._v(" "),i("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[10,20,30,40],"page-size":e.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),i("el-dialog",{staticClass:"edit-rule-form",attrs:{title:"添加文章",visible:e.dialogCreateFormVisible},on:{"update:visible":function(t){e.dialogCreateFormVisible=t}}},[i("el-form",{ref:"createForm",attrs:{model:e.createForm,rules:e.rules}},[i("el-form-item",{attrs:{label:"标题","label-width":e.formLabelWidth,prop:"title"}},[i("el-input",{attrs:{autocomplete:"off"},model:{value:e.createForm.title,callback:function(t){e.$set(e.createForm,"title",t)},expression:"createForm.title"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"自定义视频封面图链接"}},[i("el-switch",{on:{change:e.switchChange},model:{value:e.customize_preview_img,callback:function(t){e.customize_preview_img=t},expression:"customize_preview_img"}})],1),e._v(" "),e.createFormVisiblePreviewImg?i("el-form-item",{attrs:{label:"视频封面图","label-width":e.formLabelWidth}},[i("el-input",{attrs:{autocomplete:"off"},model:{value:e.createForm.preview_img,callback:function(t){e.$set(e.createForm,"preview_img",t)},expression:"createForm.preview_img"}})],1):e._e(),e._v(" "),e.createFormVisibleElUpload?i("el-form-item",{attrs:{label:"视频封面图","label-width":e.formLabelWidth}},[i("el-upload",{staticClass:"upload-demo",attrs:{action:"/sm.ms/api/upload",name:"smfile","on-preview":e.handleCreatePreviewImg,"on-success":e.handleCreateUploadPreviewImg,"on-remove":e.handleCreateRemove,"file-list":e.createForm.preview_img_show,"before-upload":e.beforeCreatePreviewImgUpload,"list-type":"picture"}},[i("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),e._v(" "),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("不超过5M")])],1)],1):e._e(),e._v(" "),i("el-form-item",{attrs:{label:"文章slug","label-width":e.formLabelWidth,prop:"slug"}},[i("el-input",{attrs:{autocomplete:"off",placeholder:"留空自动生成"},model:{value:e.createForm.slug,callback:function(t){e.$set(e.createForm,"slug",t)},expression:"createForm.slug"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"类型","label-width":e.formLabelWidth,prop:"category_id"}},[i("el-select",{attrs:{placeholder:"请选择文章类型"},model:{value:e.createForm.category_id,callback:function(t){e.$set(e.createForm,"category_id",t)},expression:"createForm.category_id"}},e._l(this.categories,function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),i("el-form-item",{attrs:{label:"是否推荐","label-width":e.formLabelWidth,prop:"is_recommend"}},[i("el-radio",{attrs:{label:"0"},model:{value:e.createForm.is_recommend,callback:function(t){e.$set(e.createForm,"is_recommend",t)},expression:"createForm.is_recommend"}},[e._v("否")]),e._v(" "),i("el-radio",{attrs:{label:"1"},model:{value:e.createForm.is_recommend,callback:function(t){e.$set(e.createForm,"is_recommend",t)},expression:"createForm.is_recommend"}},[e._v("是")])],1),e._v(" "),i("el-form-item",{attrs:{label:"视频地址","label-width":e.formLabelWidth}},[i("el-input",{attrs:{autocomplete:"off"},model:{value:e.createForm.video,callback:function(t){e.$set(e.createForm,"video",t)},expression:"createForm.video"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"文章内容","label-width":e.formLabelWidth,prop:"content"}},[i("mavon-editor",{ref:"md",staticStyle:{height:"100%"},on:{imgAdd:e.$imgAdd,imgDel:e.$imgDel},model:{value:e.createForm.content,callback:function(t){e.$set(e.createForm,"content",t)},expression:"createForm.content"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogCreateFormVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitCreateForm("createForm")}}},[e._v("确 定")])],1)],1),e._v(" "),i("el-dialog",{staticClass:"edit-rule-form",attrs:{title:"修改文章",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[i("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.rules}},[i("el-form-item",{attrs:{label:"标题","label-width":e.formLabelWidth,prop:"title"}},[i("el-input",{attrs:{autocomplete:"off"},model:{value:e.editForm.title,callback:function(t){e.$set(e.editForm,"title",t)},expression:"editForm.title"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"自定义视频封面图链接"}},[i("el-switch",{on:{change:e.switchChange},model:{value:e.customize_preview_img,callback:function(t){e.customize_preview_img=t},expression:"customize_preview_img"}})],1),e._v(" "),e.editFormVisiblePreviewImg?i("el-form-item",{attrs:{label:"视频封面图","label-width":e.formLabelWidth}},[i("el-input",{attrs:{autocomplete:"off"},model:{value:e.editForm.preview_img,callback:function(t){e.$set(e.editForm,"preview_img",t)},expression:"editForm.preview_img"}})],1):e._e(),e._v(" "),e.editFormVisibleElUpload?i("el-form-item",{attrs:{label:"视频封面图","label-width":e.formLabelWidth}},[i("el-upload",{staticClass:"upload-demo",attrs:{action:"/sm.ms/api/upload",name:"smfile","on-preview":e.handlePreviewImg,"on-success":e.handleUploadPreviewImg,"on-remove":e.handleRemove,"file-list":e.editForm.preview_img_show,"before-upload":e.beforePreviewImgUpload,"list-type":"picture"}},[i("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),e._v(" "),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("不超过5M")])],1)],1):e._e(),e._v(" "),i("el-form-item",{attrs:{label:"文章slug","label-width":e.formLabelWidth,prop:"slug"}},[i("el-input",{attrs:{autocomplete:"off",placeholder:"留空自动生成"},model:{value:e.editForm.slug,callback:function(t){e.$set(e.editForm,"slug",t)},expression:"editForm.slug"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"类型","label-width":e.formLabelWidth,prop:"category_id"}},[i("el-select",{attrs:{placeholder:"请选择文章类型"},model:{value:e.editForm.category_id,callback:function(t){e.$set(e.editForm,"category_id",t)},expression:"editForm.category_id"}},e._l(this.categories,function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),i("el-form-item",{attrs:{label:"是否推荐","label-width":e.formLabelWidth,prop:"is_recommend"}},[i("el-radio",{attrs:{label:"0"},model:{value:e.editForm.is_recommend,callback:function(t){e.$set(e.editForm,"is_recommend",t)},expression:"editForm.is_recommend"}},[e._v("否")]),e._v(" "),i("el-radio",{attrs:{label:"1"},model:{value:e.editForm.is_recommend,callback:function(t){e.$set(e.editForm,"is_recommend",t)},expression:"editForm.is_recommend"}},[e._v("是")])],1),e._v(" "),i("el-form-item",{attrs:{label:"视频地址","label-width":e.formLabelWidth}},[i("el-input",{attrs:{autocomplete:"off"},model:{value:e.editForm.video,callback:function(t){e.$set(e.editForm,"video",t)},expression:"editForm.video"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"文章内容","label-width":e.formLabelWidth,prop:"content"}},[i("mavon-editor",{ref:"md",staticStyle:{height:"100%"},on:{imgAdd:e.$imgAdd,imgDel:e.$imgDel},model:{value:e.editForm.content,callback:function(t){e.$set(e.editForm,"content",t)},expression:"editForm.content"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitEditForm("editForm")}}},[e._v("确 定")])],1)],1)],1)},[],!1,null,null,null);d.options.__file="lists.vue";t.default=d.exports},GQkZ:function(e,t,i){"use strict";var r=i("2T4I");i.n(r).a},Ztr3:function(e,t,i){"use strict";i.d(t,"b",function(){return a}),i.d(t,"c",function(){return l}),i.d(t,"d",function(){return s}),i.d(t,"e",function(){return n}),i.d(t,"a",function(){return m});var r=i("t3Un"),o=i("bs5h");function a(e){return Object(r.a)({url:o.a.CATEGORIES,method:"get",params:e})}function l(e){return Object(r.a)({url:o.a.CATEGORIES_LIST,method:"get",params:e})}function s(e){return Object(r.a)({url:o.a.CATEGORIES_LIST,method:"post",data:e})}function n(e){return Object(r.a)({url:o.a.CATEGORIES_LIST+"/"+e.id,method:"put",data:e})}function m(e){return Object(r.a)({url:o.a.CATEGORIES_LIST+"/"+e.id,method:"delete"})}}}]);