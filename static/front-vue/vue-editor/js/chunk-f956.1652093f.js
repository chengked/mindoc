(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-f956"],{"0Tir":function(e,t,i){"use strict";i.r(t);var n=i("VJl/"),o=i("SL+u");for(var r in o)"default"!==r&&function(e){i.d(t,e,function(){return o[e]})}(r);i("juo/");var a=i("KHd+"),d=Object(a.a)(o.default,n.a,n.b,!1,null,"43de2108",null);d.options.__file="edit-md.vue",t.default=d.exports},"7vU8":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{style:{width:"100vw",height:e.headerHeight,display:"flex"}},[i("div",{staticStyle:{order:"0","font-size":"40px","font-weight":"bolder"}},[e._v(e._s(e.book.book_name))]),e._v(" "),i("div",{staticStyle:{order:"1"}},[i("el-button",{staticClass:"el-icon-edit",attrs:{disabled:!e.id,type:"danger"},on:{click:e.gotoEdit}},[e._v("编辑")])],1)]),e._v(" "),i("div",{staticStyle:{display:"flex"}},[i("div",{staticStyle:{order:"0",width:"300px"},style:{height:"calc(100vh - "+e.headerHeight+")"}},[i("el-card",{style:{height:"calc(100vh - "+e.headerHeight+")",overflowY:"scroll"}},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[e._v("目录")])]),e._v(" "),i("div",[i("el-tree",{ref:"treeSelect",attrs:{data:e.tree,props:{children:"children",label:"text"},"node-key":"id","highlight-current":"","default-expanded-keys":[10],"default-expand-all":"","curren-node-key":e.id,"expand-on-click-node":!1},on:{"node-click":e.clickNode},scopedSlots:e._u([{key:"default",fn:function(t){t.node;var n=t.data;return i("span",{staticClass:"custom-tree-node"},[[e._v("\n         "+e._s(n.text)+"\n      ")]],2)}}])})],1)])],1),e._v(" "),e.currNode&&e.currNode.is_open&&2!=e.currNode.is_open?i("div",{staticStyle:{order:"1",width:"calc(100vw - 300px)"},style:{height:"calc(100vh - "+e.headerHeight+")"}},[i("div",[i("mavon-editor",{style:{height:"calc(100vh - "-e.headerHeight+")"},attrs:{toolbarsFlag:!1,subfield:!1,defaultOpen:"preview",editable:!1,boxShadow:!1},on:{change:e.handleChange},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1)]):e._e(),e._v(" "),e.editDirVisible?i("edit-dir",{ref:"editDir",attrs:{submit:e.confirmDir}}):e._e(),e._v(" "),e.editMdVisible?i("edit-md",{ref:"editMd",attrs:{submit:e.confirmMd}}):e._e()],1)])},o=[];i.d(t,"a",function(){return n}),i.d(t,"b",function(){return o})},"8ylN":function(e,t,i){},AjqV:function(e,t,i){"use strict";i.r(t);var n=i("pQ9A"),o=i.n(n);for(var r in n)"default"!==r&&function(e){i.d(t,e,function(){return n[e]})}(r);t.default=o.a},GoQ7:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getContent=function(e,t){var i=o.default.HOST+"/api/"+e.key+"/content/"+(void 0==e.id?"":e.id);return(0,n.default)({url:i,method:"get",params:t})},t.getTree=function(e,t){var i=o.default.HOST+"/api/"+e.key+"/tree";return(0,n.default)({url:i,method:"get",params:t})},t.Create=function(e,t){var i=o.default.HOST+"/api/"+e.key+"/create";return(0,n.default)({url:i,method:"post",data:t})},t.docIndex=function(e,t){var i=o.default.HOST+"/docs/"+e.key+"/info";return(0,n.default)({url:i,method:"get",data:t})};var n=r(i("t3Un")),o=r(i("bs5h"));function r(e){return e&&e.__esModule?e:{default:e}}},KaTm:function(e,t,i){"use strict";var n=i("PqvV");i.n(n).a},PqvV:function(e,t,i){},"SL+u":function(e,t,i){"use strict";i.r(t);var n=i("u8Nb"),o=i.n(n);for(var r in n)"default"!==r&&function(e){i.d(t,e,function(){return n[e]})}(r);t.default=o.a},"VJl/":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:e.key?"编辑":"添加文档",visible:e.visible,width:"30%",center:""},on:{"update:visible":function(t){e.visible=t}}},[i("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"是否展开",prop:"isOpen"}},[i("el-radio-group",{model:{value:e.form.isOpen,callback:function(t){e.$set(e.form,"isOpen",t)},expression:"form.isOpen"}},[i("el-radio",{attrs:{label:1}},[e._v("展开")]),e._v(" "),i("el-radio",{attrs:{label:0}},[e._v("折叠")])],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"名称",prop:"name"}},[i("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),e._v(" "),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{label:"t",prop:"t"}})],1),e._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确 定")])],1)],1)},o=[];i.d(t,"a",function(){return n}),i.d(t,"b",function(){return o})},"eWX/":function(e,t,i){"use strict";var n=i("8ylN");i.n(n).a},esWS:function(e,t,i){},"juo/":function(e,t,i){"use strict";var n=i("esWS");i.n(n).a},nWTU:function(e,t,i){"use strict";i.r(t);var n=i("xmZf"),o=i.n(n);for(var r in n)"default"!==r&&function(e){i.d(t,e,function(){return n[e]})}(r);t.default=o.a},njmX:function(e,t,i){"use strict";i.r(t);var n=i("qpqA"),o=i("nWTU");for(var r in o)"default"!==r&&function(e){i.d(t,e,function(){return o[e]})}(r);i("eWX/");var a=i("KHd+"),d=Object(a.a)(o.default,n.a,n.b,!1,null,"2565d138",null);d.options.__file="edit-dir.vue",t.default=d.exports},nvaH:function(e,t,i){"use strict";i.r(t);var n=i("7vU8"),o=i("AjqV");for(var r in o)"default"!==r&&function(e){i.d(t,e,function(){return o[e]})}(r);i("KaTm");var a=i("KHd+"),d=Object(a.a)(o.default,n.a,n.b,!1,null,"4335f792",null);d.options.__file="view-doc.vue",t.default=d.exports},pQ9A:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=p(i("FyfS")),o=i("GoQ7"),r=i("xucW"),a=p(i("NsiU")),d=p(i("ynI1")),s=p(i("a/Yz")),l=p(i("EgDG")),c=p(i("49DM")),u=p(i("5J6R")),f=p(i("8HqY")),h=p(i("D9AB")),v=p(i("njmX")),m=p(i("0Tir"));function p(e){return e&&e.__esModule?e:{default:e}}var b=[(0,s.default)(),(0,l.default)(),(0,u.default)(),(0,c.default)(),(0,f.default)(),(0,h.default)()];t.default={name:"EditDoc",components:{Editor:d.default,Viewer:r.Viewer,"tinymce-editor":d.default,EditDir:v.default,EditMd:m.default},data:function(){return{key:this.$route.params.key,id:this.$route.params.id,tree:void 0,content:"",currNode:{},book:{book_id:void 0,book_name:void 0},plugins:b,zhHans:a.default,title:"",checkedKeys:[10],init:{language_url:"/lib/js/zh_CN.js",language:"zh_CN",height:430,plugins:"link lists image code table colorpicker textcolor wordcount contextmenu",toolbar:"bold italic underline strikethrough | fontsizeselect | forecolor backcolor | alignleft aligncenter alignright alignjustify|bullist numlist |outdent indent blockquote | undo redo | link unlink image code | removeformat",branding:!1,images_upload_handler:function(e,t,i){t("data:image/jpeg;base64,"+e.base64())}},editDirVisible:!1,editMdVisible:!1,menuVisible:!1,visible:!1,top:0,left:0,headerHeight:"60px",currRightNode:{id:void 0}}},mounted:function(){this.id&&(this.checkedKeys=[],this.checkedKeys.push(this.id)),this.docIndex(),this.reqContent()},watch:{visible:function(e){}},methods:{gotoEdit:function(){this.$router.push({name:"editDoc2"})},openMenu:function(e,t){this.currRightNode=void 0,console.log(e,t);var i=this.$el.getBoundingClientRect().left,n=this.$el.offsetWidth-105,o=e.clientX-i;this.left=o>n?n:o,this.top=e.clientY-60,this.top<0&&(this.top=0),this.currRightNode=t,this.visible=!0},editDir:function(){var e=this;this.visible=!1,this.editDirVisible=!0,this.$nextTick(function(){e.$refs.editDir.init()})},editMarkdown:function(){var e=this;this.visible=!1,this.editMdVisible=!0,this.$nextTick(function(){e.$refs.editMd.init()})},confirmDir:function(e){var t=this,i={};i.identify=this.key,i.doc_id=0,i.doc_identify=this.key+"-"+e.t,i.doc_name=e.name,i.parent_id=this.currRightNode&&this.currRightNode.id?this.currRightNode.id:0,i.is_open=2,i.content="",(0,o.Create)({key:this.key},i).then(function(e){console.log(e.data.data),0==e.data.errcode&&t.reqTree()})},confirmMd:function(e){var t=this,i={};i.identify=this.key,i.doc_id=0,i.doc_identify=this.key+"-"+e.t,i.doc_name=e.name,i.parent_id=this.currRightNode&&this.currRightNode.id?this.currRightNode.id:0,i.is_open=e.isOpen,i.content="",(0,o.Create)({key:this.key},i).then(function(e){console.log(e.data.data),0==e.data.errcode&&t.reqTree()})},saveContent:function(){var e=this.currNode;e.doc_identify=""+e.identify,e.identify=this.key,e.content="",e.content=""+this.content,console.log(e.content),(0,o.Create)({key:this.key},e).then(function(e){console.log(e.data.data)})},reqTree:function(){var e=this;(0,o.getTree)({key:this.key},{}).then(function(t){console.log(t.data),e.tree=e.listToTreeList(JSON.parse(t.data.data)),e.$nextTick(function(){e.$refs.treeSelect.setCurrentKey(e.id)})})},reqContent:function(){void 0!=this.id&&this.getContent({key:this.key,id:this.id})},getContent:function(e){var t=this;(0,o.getContent)(e).then(function(e){console.log(e.data.data),t.content=e.data.data.content,t.currNode=e.data.data})},clickNode:function(e){this.visible=!1,this.title=e.text,this.id=e.id,this.$router.replace({name:"viewDoc2",params:{key:this.key,id:e.id}}),this.getContent({key:this.key,id:e.id})},handleChange:function(e){this.content=e},listToTreeList:function(e){if(!e||!e.length)return[];var t={},i=!0,o=!1,r=void 0;try{for(var a,d=(0,n.default)(e);!(i=(a=d.next()).done);i=!0){var s=a.value;t[s.id]=s}}catch(e){o=!0,r=e}finally{try{!i&&d.return&&d.return()}finally{if(o)throw r}}for(var l=0;l<e.length;l++)e[l].parent&&t[e[l].parent]&&(t[e[l].parent].children||(t[e[l].parent].children=[]),t[e[l].parent].children.push(e[l]),e.splice(l,1),l--);return e},docIndex:function(){var e=this;(0,o.docIndex)({key:this.key},{}).then(function(t){console.log(t.data.data);var i=t.data;0==i.errcode&&(e.book=i.data,e.reqTree())})}}}},qpqA:function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{title:e.key?"编辑":"添加目录",visible:e.visible,width:"30%",center:""},on:{"update:visible":function(t){e.visible=t}}},[i("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"目录名称",prop:"name"}},[i("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1)],1),e._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取 消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.confirm}},[e._v("确 定")])],1)],1)},o=[];i.d(t,"a",function(){return n}),i.d(t,"b",function(){return o})},u8Nb:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"edit-dir",props:{submit:{type:Function,default:function(){}}},data:function(){return{key:void 0,visible:!1,form:{key:void 0,name:"",t:(new Date).getTime(),isOpen:1}}},methods:{init:function(e){this.visible=!0},confirm:function(){this.submit(this.form),this.$refs.form.resetFields(),this.visible=!1}}}},xmZf:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"edit-dir",props:{submit:{type:Function,default:function(){}}},data:function(){return{key:void 0,visible:!1,form:{key:void 0,name:"",t:(new Date).getTime(),isOpen:!1}}},methods:{init:function(e){var t=this;this.visible=!0,this.$nextTick(function(){t.$refs.form.resetFields()})},confirm:function(){this.submit(this.form),this.$refs.form.resetFields(),this.visible=!1}}}}}]);