(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-7e02"],{"0Tir":function(t,e,i){"use strict";i.r(e);var n=i("VJl/"),r=i("SL+u");for(var o in r)"default"!==o&&function(t){i.d(e,t,function(){return r[t]})}(o);i("juo/");var a=i("KHd+"),s=Object(a.a)(r.default,n.a,n.b,!1,null,"43de2108",null);s.options.__file="edit-md.vue",e.default=s.exports},"0b1c":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=p(i("FyfS")),r=i("GoQ7"),o=i("xucW"),a=p(i("NsiU")),s=p(i("ynI1")),l=p(i("a/Yz")),d=p(i("EgDG")),c=p(i("49DM")),u=p(i("5J6R")),f=p(i("8HqY")),h=p(i("D9AB")),v=p(i("njmX")),m=p(i("0Tir"));function p(t){return t&&t.__esModule?t:{default:t}}var b=[(0,l.default)(),(0,d.default)(),(0,u.default)(),(0,c.default)(),(0,f.default)(),(0,h.default)()];e.default={name:"EditDoc",components:{Editor:s.default,Viewer:o.Viewer,"tinymce-editor":s.default,EditDir:v.default,EditMd:m.default},data:function(){return{key:this.$route.params.key,id:this.$route.params.id,tree:void 0,content:"",currNode:{},plugins:b,zhHans:a.default,title:"",checkedKeys:[10],init:{language_url:"/lib/js/zh_CN.js",language:"zh_CN",height:430,plugins:"link lists image code table colorpicker textcolor wordcount contextmenu",toolbar:"bold italic underline strikethrough | fontsizeselect | forecolor backcolor | alignleft aligncenter alignright alignjustify|bullist numlist |outdent indent blockquote | undo redo | link unlink image code | removeformat",branding:!1,images_upload_handler:function(t,e,i){e("data:image/jpeg;base64,"+t.base64())}},editDirVisible:!1,editMdVisible:!1,menuVisible:!1,visible:!1,top:0,left:0,currRightNode:{id:void 0}}},mounted:function(){this.id&&(this.checkedKeys=[],this.checkedKeys.push(this.id)),this.reqTree(),this.reqContent()},watch:{visible:function(t){}},methods:{openMenu:function(t,e){this.currRightNode=void 0,console.log(t,e);var i=this.$el.getBoundingClientRect().left,n=this.$el.offsetWidth-105,r=t.clientX-i;this.left=r>n?n:r,this.top=t.clientY-60,this.top<0&&(this.top=0),this.currRightNode=e,this.visible=!0},editDir:function(){var t=this;this.visible=!1,this.editDirVisible=!0,this.$nextTick(function(){t.$refs.editDir.init()})},editMarkdown:function(){var t=this;this.visible=!1,this.editMdVisible=!0,this.$nextTick(function(){t.$refs.editMd.init()})},confirmDir:function(t){var e=this,i={};i.identify=this.key,i.doc_id=0,i.doc_identify=this.key+"-"+t.t,i.doc_name=t.name,i.parent_id=this.currRightNode&&this.currRightNode.id?this.currRightNode.id:0,i.is_open=2,i.content="",(0,r.Create)({key:this.key},i).then(function(t){console.log(t.data.data),0==t.data.errcode&&e.reqTree()})},confirmMd:function(t){var e=this,i={};i.identify=this.key,i.doc_id=0,i.doc_identify=this.key+"-"+t.t,i.doc_name=t.name,i.parent_id=this.currRightNode&&this.currRightNode.id?this.currRightNode.id:0,i.is_open=t.isOpen,i.content="",(0,r.Create)({key:this.key},i).then(function(t){console.log(t.data.data),0==t.data.errcode&&e.reqTree()})},saveContent:function(){var t=this.currNode;t.doc_identify=""+t.identify,t.identify=this.key,t.content="",t.content=""+this.content,console.log(t.content),(0,r.Create)({key:this.key},t).then(function(t){console.log(t.data.data)})},reqTree:function(){var t=this;(0,r.getTree)({key:this.key},{}).then(function(e){console.log(e.data),t.tree=t.listToTreeList(JSON.parse(e.data.data)),t.$nextTick(function(){t.$refs.treeSelect.setCurrentKey(t.id)})})},reqContent:function(){void 0!=this.id&&this.getContent({key:this.key,id:this.id})},getContent:function(t){var e=this;(0,r.getContent)(t).then(function(t){console.log(t.data.data),e.content=t.data.data.content,e.currNode=t.data.data})},clickNode:function(t){this.visible=!1,this.title=t.text,this.id=t.id,this.$router.replace({name:"editDoc2",params:{key:this.key,id:t.id}}),this.getContent({key:this.key,id:t.id})},handleChange:function(t){this.content=t},listToTreeList:function(t){if(!t||!t.length)return[];var e={},i=!0,r=!1,o=void 0;try{for(var a,s=(0,n.default)(t);!(i=(a=s.next()).done);i=!0){var l=a.value;e[l.id]=l}}catch(t){r=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}for(var d=0;d<t.length;d++)t[d].parent&&e[t[d].parent]&&(e[t[d].parent].children||(e[t[d].parent].children=[]),e[t[d].parent].children.push(t[d]),t.splice(d,1),d--);return t}}}},"1aP0":function(t,e,i){"use strict";i.r(e);var n=i("0b1c"),r=i.n(n);for(var o in n)"default"!==o&&function(t){i.d(e,t,function(){return n[t]})}(o);e.default=r.a},"3YbL":function(t,e,i){"use strict";var n=i("zrD2");i.n(n).a},"8ylN":function(t,e,i){},GoQ7:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getContent=function(t,e){var i=r.default.HOST+"/api/"+t.key+"/content/"+(void 0==t.id?"":t.id);return(0,n.default)({url:i,method:"get",params:e})},e.getTree=function(t,e){var i=r.default.HOST+"/api/"+t.key+"/tree";return(0,n.default)({url:i,method:"get",params:e})},e.Create=function(t,e){var i=r.default.HOST+"/api/"+t.key+"/create";return(0,n.default)({url:i,method:"post",data:e})},e.docIndex=function(t,e){var i=r.default.HOST+"/docs/"+t.key+"/info";return(0,n.default)({url:i,method:"get",data:e})};var n=o(i("t3Un")),r=o(i("bs5h"));function o(t){return t&&t.__esModule?t:{default:t}}},"SL+u":function(t,e,i){"use strict";i.r(e);var n=i("u8Nb"),r=i.n(n);for(var o in n)"default"!==o&&function(t){i.d(e,t,function(){return n[t]})}(o);e.default=r.a},"VJl/":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{title:t.key?"编辑":"添加文档",visible:t.visible,width:"30%",center:""},on:{"update:visible":function(e){t.visible=e}}},[i("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"是否展开",prop:"isOpen"}},[i("el-radio-group",{model:{value:t.form.isOpen,callback:function(e){t.$set(t.form,"isOpen",e)},expression:"form.isOpen"}},[i("el-radio",{attrs:{label:1}},[t._v("展开")]),t._v(" "),i("el-radio",{attrs:{label:0}},[t._v("折叠")])],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"名称",prop:"name"}},[i("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),i("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{label:"t",prop:"t"}})],1),t._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.visible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.confirm}},[t._v("确 定")])],1)],1)},r=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return r})},"eWX/":function(t,e,i){"use strict";var n=i("8ylN");i.n(n).a},esWS:function(t,e,i){},"juo/":function(t,e,i){"use strict";var n=i("esWS");i.n(n).a},nWTU:function(t,e,i){"use strict";i.r(e);var n=i("xmZf"),r=i.n(n);for(var o in n)"default"!==o&&function(t){i.d(e,t,function(){return n[t]})}(o);e.default=r.a},njmX:function(t,e,i){"use strict";i.r(e);var n=i("qpqA"),r=i("nWTU");for(var o in r)"default"!==o&&function(t){i.d(e,t,function(){return r[t]})}(o);i("eWX/");var a=i("KHd+"),s=Object(a.a)(r.default,n.a,n.b,!1,null,"2565d138",null);s.options.__file="edit-dir.vue",e.default=s.exports},qpqA:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{title:t.key?"编辑":"添加目录",visible:t.visible,width:"30%",center:""},on:{"update:visible":function(e){t.visible=e}}},[i("el-form",{ref:"form",attrs:{model:t.form,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"目录名称",prop:"name"}},[i("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),t._v(" "),i("span",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.visible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.confirm}},[t._v("确 定")])],1)],1)},r=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return r})},u8Nb:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"edit-dir",props:{submit:{type:Function,default:function(){}}},data:function(){return{key:void 0,visible:!1,form:{key:void 0,name:"",t:(new Date).getTime(),isOpen:1}}},methods:{init:function(t){this.visible=!0},confirm:function(){this.submit(this.form),this.$refs.form.resetFields(),this.visible=!1}}}},wiev:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{display:"flex"}},[i("div",{staticStyle:{order:"0",width:"300px"}},[i("el-card",{staticStyle:{height:"calc(100vh)","overflow-y":"scroll"}},[i("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[i("span",[t._v("目录")]),t._v(" "),i("el-button",{staticClass:"el-icon-plus",staticStyle:{float:"right",padding:"3px 0"},on:{click:function(e){t.openMenu(e,void 0)}}})],1),t._v(" "),i("div",[i("el-tree",{ref:"treeSelect",attrs:{data:t.tree,props:{children:"children",label:"text"},"node-key":"id","highlight-current":"","default-expanded-keys":[10],"default-expand-all":"","curren-node-key":t.id,"expand-on-click-node":!1},on:{"node-click":t.clickNode},scopedSlots:t._u([{key:"default",fn:function(e){e.node;var n=e.data;return i("span",{staticClass:"custom-tree-node",on:{contextmenu:function(e){e.preventDefault(),t.openMenu(e,n)}}},[[t._v("\n         "+t._s(n.text)+"\n      ")]],2)}}])})],1)])],1),t._v(" "),t.currNode&&t.currNode.is_open&&2!=t.currNode.is_open?i("div",{staticStyle:{order:"1",width:"calc(100vw - 300px)"}},[i("div",{staticStyle:{"border-style":"outset",height:"60px",display:"flex"}},[i("div",{staticClass:"margin_right_20px",staticStyle:{order:"0"}},[i("el-button",{attrs:{type:"primary",icon:"el-icon-document"},on:{click:t.saveContent}})],1),t._v(" "),i("div",{staticClass:"margin_right_20px",staticStyle:{order:"1"}},[i("el-button",{attrs:{type:"primary",icon:"el-icon-full-screen"}})],1)]),t._v(" "),i("div",[i("mavon-editor",{staticStyle:{height:"calc(100vh - 60px)"},on:{change:t.handleChange},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1)]):t._e(),t._v(" "),t.editDirVisible?i("edit-dir",{ref:"editDir",attrs:{submit:t.confirmDir}}):t._e(),t._v(" "),t.editMdVisible?i("edit-md",{ref:"editMd",attrs:{submit:t.confirmMd}}):t._e(),t._v(" "),i("ul",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"contextmenu",style:{left:t.left+"px",top:t.top+"px"}},[i("li",{attrs:{command:"create-dir"},on:{click:t.editDir}},[t._v("空目录")]),t._v(" "),i("li",{attrs:{command:"create-markdown"},on:{click:t.editMarkdown}},[t._v("markdown(mavon-editor)")]),t._v(" "),i("li",[t._v("Word文档")])])],1)},r=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return r})},wvNx:function(t,e,i){"use strict";i.r(e);var n=i("wiev"),r=i("1aP0");for(var o in r)"default"!==o&&function(t){i.d(e,t,function(){return r[t]})}(o);i("3YbL");var a=i("KHd+"),s=Object(a.a)(r.default,n.a,n.b,!1,null,"33e62e7a",null);s.options.__file="edit-doc.vue",e.default=s.exports},xmZf:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"edit-dir",props:{submit:{type:Function,default:function(){}}},data:function(){return{key:void 0,visible:!1,form:{key:void 0,name:"",t:(new Date).getTime(),isOpen:!1}}},methods:{init:function(t){var e=this;this.visible=!0,this.$nextTick(function(){e.$refs.form.resetFields()})},confirm:function(){this.submit(this.form),this.$refs.form.resetFields(),this.visible=!1}}}},zrD2:function(t,e,i){}}]);